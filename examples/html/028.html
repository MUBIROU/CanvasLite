
<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>028 グリッド with ToileJS</title>
        <script src="https://takashinishimura.github.io/ToileJS/toile_test.js"></script>
        <script src="../js/Grid.js"></script>
        <script>
            addEventListener("load", load_window, false);

            function load_window() {
                _canvas = new toile.Canvas("myCanvas");
                _canvas.addEventListener("enterframe", enterframe_canvas);
                _canvas.addEventListener("mousedown", mousedown_canvas);
                _canvas.fps = 60;
                _canvas.enabledContextMenu(false);
                _canvas.isBorder(true);

                _bitmap = new toile.Bitmap("../png/yubi.png");
                _bitmap.alpha = 0.2;
                _bitmap.x = _canvas.width/2 - 50;
                _bitmap.y = _canvas.height/2 - 80;
                _canvas.addChild(_bitmap);

                _gridStatus = "off"; //Gridの表示状態
            }

            enterframe_canvas = (_canvas) => {
                _canvas.drawScreen("#ffffff");
            }

            mousedown_canvas = (_canvas) => {
                if (_gridStatus == "off") {
                    _grid = new Grid(_canvas,10,10); //Canvasを横10,縦6に分割
                    //_grid.create(); //アニメーション無しで表示したい場合
                    _grid.lineAlpha = 0.3; //初期値1
                    _grid.lineColor = "0,0,0"; //初期値"0,0,0"
                    _grid.lineWidth = 12; //初期値1
                    _grid.animateIn(2); //初期値2（秒）
                    _grid.addEventListener("animateInEnd", animateInEnd_grid);
                    _gridStatus = "animate"; //Gridの表示状態
                } else if (_gridStatus == "on") {
                    //_grid.delete(); //アニメーション無しで消去したい場合
                    _grid.lineAlpha = 1; //初期値1
                    _grid.lineColor = "51,102,204"; //初期値"0,0,0"
                    _grid.lineWidth = 1; //初期値1
                    _grid.animateOut(2); //初期値2（秒）
                    _grid.addEventListener("animateOutEnd", animateOutEnd_grid);
                    _gridStatus = "animate"; //Gridの表示状態
                } else if (_gridStatus == "animate") {
                    //"animate"中は未処理
                }
            }

            animateInEnd_grid = (_grid) => {
                _gridStatus = "on"; //Gridの表示状態
                _grid.removeEventListener("animateInEnd");
                
                //アニメーション完了直後に設定変更したい場合...
                _grid.lineAlpha = 1; //初期値1
                _grid.lineColor = "0,0,0"; //初期値"0,0,0"
                _grid.lineWidth = 2; //初期値1
            }

            animateOutEnd_grid = (_grid) => {
                _gridStatus = "off";
                _grid.removeEventListener("animateOutEnd");
            }
        </script>
        <style>
            body {
                background:#fff;
                margin:0;
                padding:0;
                overflow:hidden;
            }
        </style>
    </head>
    <body>
        <canvas id="myCanvas" width="700" height="700"></canvas>
    </body>
</html>

<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>026 Circle/RectとBitmap/SpriteSheetの接触 with ToileJS</title>
        <script src="https://takashinishimura.github.io/ToileJS/toile_test.js"></script>
        <script>
            addEventListener("load", load_window, false);

            function load_window() {
                _mouseX = _mouseY = 0;
                
                //Canvasクラス
                _canvas = new toile.Canvas("myCanvas");
                _canvas.addEventListener("enterframe", enterframe_canvas); 	_canvas.enabledContextMenu(false);
                _canvas.addEventListener("mousemove", mousemove_canvas);
                _canvas.enabledMouseMove(true);
                _canvas.isBorder(true);

                //Bitmap
                _bitmap = new toile.Bitmap("../jpg/bitmapSample.jpg");
                _bitmap.x = 182;
                _bitmap.y = 194;
                _bitmap.scale = 0.5;
                _canvas.addChild(_bitmap);

                //SpriteSheet
                _spriteSheet = new toile.SpriteSheet("../jpg/run.jpg"); //("run.png");
                _spriteSheet.x = 491;
                _spriteSheet.y = 194;
                _spriteSheet.scale = 0.5;
                _spriteSheet.fps = 10;
                _canvas.addChild(_spriteSheet);

                //Rect
                _rect = new toile.Rect(0,0,50,50);
                _canvas.addChild(_rect);
            }

            enterframe_canvas = (_canvas) => {
                _rect.x = _mouseX;
                _rect.y = _mouseY;

                //hitTest（Bitmapとの接触）
                if (_rect.hitTest(_bitmap)) {
                    console.log("Rect: Bitmapと接触中");
                }

                //hitTest（SpriteSheetとの接触）
                if (_rect.hitTest(_spriteSheet)) {
                    console.log("Rect: SpriteSheetと接触中");
                }

                _canvas.drawScreen("#cccccc");
            }

            mousemove_canvas = (_canvas) => {
                _mouseX = _canvas.mouseX;
                _mouseY = _canvas.mouseY;
            }
        </script>
        <style>
            body {
                background:#fff;
                margin:0;
                padding:0;
                overflow:hidden;
            }
        </style>
    </head>
    <body>
        <canvas id="myCanvas" width="800" height="600"></canvas>
    </body>
</html>
